/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var t={98362:function(t,n,e){t.exports=e.p+"assets/logo-filled.png"},58394:function(t,n,e){t.exports=e.p+"fae45caf24abcc498a30.css"}},n={};function e(r){var a=n[r];if(void 0!==a)return a.exports;var o=n[r]={exports:{}};return t[r](o,o.exports,e),o.exports}e.m=t,e.d=function(t,n){for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},function(){var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(t=n.currentScript.src),!t)){var r=n.getElementsByTagName("script");if(r.length)for(var a=r.length-1;a>-1&&(!t||!/^http(s?):/.test(t));)t=r[a--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t}(),e.b=document.baseURI||self.location.href,function(){function t(n){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(n)}function n(){n=function(){return r};var e,r={},a=Object.prototype,o=a.hasOwnProperty,i=Object.defineProperty||function(t,n,e){t[n]=e.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",l=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function f(t,n,e){return Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[n]}try{f({},"")}catch(e){f=function(t,n,e){return t[n]=e}}function p(t,n,e,r){var a=n&&n.prototype instanceof b?n:b,o=Object.create(a.prototype),s=new _(r||[]);return i(o,"_invoke",{value:j(t,e,s)}),o}function d(t,n,e){try{return{type:"normal",arg:t.call(n,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=p;var h="suspendedStart",v="suspendedYield",m="executing",y="completed",g={};function b(){}function w(){}function x(){}var E={};f(E,c,(function(){return this}));var S=Object.getPrototypeOf,L=S&&S(S(R([])));L&&L!==a&&o.call(L,c)&&(E=L);var k=x.prototype=b.prototype=Object.create(E);function O(t){["next","throw","return"].forEach((function(n){f(t,n,(function(t){return this._invoke(n,t)}))}))}function A(n,e){function r(a,i,s,c){var l=d(n[a],n,i);if("throw"!==l.type){var u=l.arg,f=u.value;return f&&"object"==t(f)&&o.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,s,c)}),(function(t){r("throw",t,s,c)})):e.resolve(f).then((function(t){u.value=t,s(u)}),(function(t){return r("throw",t,s,c)}))}c(l.arg)}var a;i(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,a){r(t,n,e,a)}))}return a=a?a.then(o,o):o()}})}function j(t,n,r){var a=h;return function(o,i){if(a===m)throw Error("Generator is already running");if(a===y){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var s=r.delegate;if(s){var c=N(s,r);if(c){if(c===g)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===h)throw a=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=m;var l=d(t,n,r);if("normal"===l.type){if(a=r.done?y:v,l.arg===g)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(a=y,r.method="throw",r.arg=l.arg)}}}function N(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,N(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=d(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(t){var n={tryLoc:t[0]};1 in t&&(n.catchLoc=t[1]),2 in t&&(n.finallyLoc=t[2],n.afterLoc=t[3]),this.tryEntries.push(n)}function I(t){var n=t.completion||{};n.type="normal",delete n.arg,t.completion=n}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function R(n){if(n||""===n){var r=n[c];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var a=-1,i=function t(){for(;++a<n.length;)if(o.call(n,a))return t.value=n[a],t.done=!1,t;return t.value=e,t.done=!0,t};return i.next=i}}throw new TypeError(t(n)+" is not iterable")}return w.prototype=x,i(k,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===w||"GeneratorFunction"===(n.displayName||n.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},r.awrap=function(t){return{__await:t}},O(A.prototype),f(A.prototype,l,(function(){return this})),r.AsyncIterator=A,r.async=function(t,n,e,a,o){void 0===o&&(o=Promise);var i=new A(p(t,n,e,a),o);return r.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},O(k),f(k,u,"Generator"),f(k,c,(function(){return this})),f(k,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var n=Object(t),e=[];for(var r in n)e.push(r);return e.reverse(),function t(){for(;e.length;){var r=e.pop();if(r in n)return t.value=r,t.done=!1,t}return t.done=!0,t}},r.values=R,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(r,a){return s.type="throw",s.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=o.call(i,"catchLoc"),l=o.call(i,"finallyLoc");if(c&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,n){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=n&&n<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=n,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(i)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),g},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var e=this.tryEntries[n];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),I(e),g}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var e=this.tryEntries[n];if(e.tryLoc===t){var r=e.completion;if("throw"===r.type){var a=r.arg;I(e)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:R(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},r}function e(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return r(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?r(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function a(t,n,e,r,a,o,i){try{var s=t[o](i),c=s.value}catch(t){return void e(t)}s.done?n(c):Promise.resolve(c).then(r,a)}function o(){return i.apply(this,arguments)}function i(){var t;return t=n().mark((function t(){var e,r,a,o,i,f,p,d,g,b,w,x;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Office.context.mailbox.item,document.getElementById("loading-bar").style.display="block",document.getElementById("email-details").innerHTML="",r=e.from?e.from.emailAddress:"Unknown Sender",a=e.subject,t.next=7,s(e);case 7:return o=t.sent,i=c(o),t.next=11,l(e);case 11:return f=t.sent,p=u(f),console.log("Extracted Authentication Results",p),d={sender_domain:r.split("@")[1],subject:a,body:o,url_count:i.length,urls:i,spf:p.spf,dkim:p.dkim,dmarc:p.dmarc},console.log("Payload sent to backend:",JSON.stringify(d,null,2)),t.prev=16,t.next=20,fetch("http://localhost:5000/analyze-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});case 20:if((g=t.sent).ok){t.next=25;break}return console.error("Server Error:",g.statusText),document.getElementById("email-details").innerHTML="<b>Error analyzing email. Server error.</b>",t.abrupt("return");case 25:return t.next=27,g.json();case 27:if(b=t.sent,console.log("Response from backend:",b),b.label&&void 0!==b.confidence){t.next=33;break}return console.error("Unexpected Response Format:",b),document.getElementById("email-details").innerHTML="<b>Error analyzing email. Unexpected response format.</b>",t.abrupt("return");case 33:w=document.getElementById("email-details"),x=b.label.toLowerCase(),w.innerHTML="\n      ".concat(h(x,b.confidence),"\n      ").concat(v(x,b.confidence),"\n      ").concat(m(p,b.auth_status),"\n      ").concat(y(b.link_analysis),"\n      ").concat('\n    <div class="export-section">\n      <button id="export-btn" class="export-button">\n        📥 Export Analysis Results\n      </button>\n    </div>\n  ',"\n    "),window.exportResults=function(t){var n=JSON.stringify(t,null,2),e="data:application/json;charset=utf-8,"+encodeURIComponent(n),r=document.createElement("a");r.setAttribute("href",e),r.setAttribute("download","email-analysis-results.json"),r.click()},document.getElementById("export-btn").addEventListener("click",(function(){window.exportResults(b)})),t.next=44;break;case 40:t.prev=40,t.t0=t.catch(16),console.error("Error:",t.t0),document.getElementById("email-details").innerHTML="<b>Error analyzing email. Please try again.</b>";case 44:return t.prev=44,document.getElementById("loading-bar").style.display="none",t.finish(44);case 47:case"end":return t.stop()}}),t,null,[[16,40,44,47]])})),i=function(){var n=this,e=arguments;return new Promise((function(r,o){var i=t.apply(n,e);function s(t){a(i,r,o,s,c,"next",t)}function c(t){a(i,r,o,s,c,"throw",t)}s(void 0)}))},i.apply(this,arguments)}function s(t){return new Promise((function(n){t.body.getAsync(Office.CoercionType.Text,(function(t){t.status===Office.AsyncResultStatus.Succeeded?n(t.value):n("Failed to retrieve body.")}))}))}function c(t){var n=t.match(/(https?:\/\/[^\s"<>\)]+)/g)||[],r=e(new Set(n.map((function(t){return t.replace(/\/+$/,"")})))).map((function(t){try{return new URL(t).hostname}catch(n){return t}}));return e(new Set(r))}function l(t){return new Promise((function(n){t.getAllInternetHeadersAsync((function(t){t.status===Office.AsyncResultStatus.Succeeded?n(t.value):n("")}))}))}function u(t){return{spf:f(t),dkim:p(t),dmarc:d(t)}}function f(t){var n=t.match(/Received-SPF:\s*(pass|fail|none|softfail)/i);return n?n[1].toUpperCase():"NONE"}function p(t){var n=t.match(/dkim=(pass|fail|none)/i);return n?n[1].toUpperCase():"NONE"}function d(t){var n=t.match(/dmarc=(pass|fail|none)/i);return n?n[1].toUpperCase():"NONE"}function h(t,n){return'\n    <div class="prediction-banner" data-type="'.concat("legitimate"===t?"safe":t,'">\n      <div class="prediction-text" data-type="').concat("legitimate"===t?"safe":t,'">\n        ').concat("phishing"===t?"⚠️ Suspicious Email":"spam"===t?"📧 Spam Email":"✅ Safe Email",'\n      </div>\n      <div class="confidence-badge">').concat(n,"% Confidence</div>\n    </div>\n  ")}function v(t,n){return'\n    <div class="result-section">\n      <div class="result-title">📝 Email Classification</div>\n      <div class="result-item">\n        <span class="result-label">Type:</span>\n        <span class="result-value">'.concat(t.charAt(0).toUpperCase()+t.slice(1),'</span>\n      </div>\n      <div class="result-item">\n        <span class="result-label">Confidence:</span>\n        <span class="result-value">').concat(n,"%</span>\n      </div>\n    </div>\n  ")}function m(t,n){return'\n    <div class="result-section">\n      <div class="result-title">🔒 Email Authentication</div>\n      <div class="result-item">\n        <span class="result-label">SPF:</span>\n        <span class="result-value">'.concat(t.spf,'</span>\n      </div>\n      <div class="result-item">\n        <span class="result-label">DKIM:</span>\n        <span class="result-value">').concat(t.dkim,'</span>\n      </div>\n      <div class="result-item">\n        <span class="result-label">DMARC:</span>\n        <span class="result-value">').concat(t.dmarc,'</span>\n      </div>\n      <div class="result-item">\n        <span class="result-label">Status:</span>\n        <span class="result-value">').concat(n,"</span>\n      </div>\n    </div>\n  ")}function y(t){if(!t||0===t.length)return'\n      <div class="result-section">\n        <div class="result-title">🔗 Link Analysis</div>\n        <div class="result-item"><span class="result-value">No URLs found in the email.</span></div>\n      </div>\n    ';var n=t.map((function(n,e){var r,a,o,i=n.domain||"N/A",s=null!==(r=n.malicious_count)&&void 0!==r?r:"N/A",c=null!==(a=n.domain_age)&&void 0!==a?a:"N/A",l=null!==(o=n.risk_score)&&void 0!==o?o:"N/A",u=l>=10?"status-high-risk":l>=5?"status-suspicious":"status-safe",f=l>=10||l>=5?"⚠️":"✅",p=l>=10?"High Risk":l>=5?"Suspicious":"Safe";return'\n      <div class="domain-analysis">\n        <div class="result-item">\n          <span class="result-label">Domain:</span>\n          <span class="result-value">'.concat(i,'</span>\n        </div>\n        <div class="result-item">\n          <span class="result-label">Risk Status:</span>\n          <span class="status-indicator ').concat(u,'">\n            ').concat(f," ").concat(p,'\n          </span>\n        </div>\n        <div class="result-item">\n          <span class="result-label">Risk Score:</span>\n          <span class="result-value">').concat(l,'</span>\n        </div>\n        <div class="result-item">\n          <span class="result-label">Malicious Count:</span>\n          <span class="result-value">').concat(s,'</span>\n        </div>\n        <div class="result-item">\n          <span class="result-label">Domain Age:</span>\n          <span class="result-value">').concat(c," days</span>\n        </div>\n        ").concat(n.warning?'\n          <div class="result-item">\n            <span class="result-label">Warning:</span>\n            <span class="result-value warning-icon">⚠️ '.concat(n.warning,"</span>\n          </div>\n        "):"","\n        ").concat(e<t.length-1?'<div class="domain-separator"></div>':"","\n      </div>\n    ")})).join("");return'\n    <div class="result-section">\n      <div class="result-title">🔗 Link Analysis</div>\n      '.concat(n,"\n    </div>\n  ")}Office.onReady((function(t){t.host===Office.HostType.Outlook&&(document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("run").onclick=o)}))}(),new URL(e(58394),e.b),new URL(e(98362),e.b)}();
//# sourceMappingURL=taskpane.js.map